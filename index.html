<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - ElHaji Auto</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #1a202c;
      --secondary: #3182ce;
      --accent: #e53e3e;
      --light: #f9fafb;
      --dark: #2c3e50;
      --gray: #718096;
      --success: #48bb78;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #1a202c, #2d3748);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      color: var(--light);
    }
    
    .admin-container {
      width: 100%;
      max-width: 1200px;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    
    .admin-header {
      background: var(--primary);
      padding: 25px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .admin-logo {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .admin-logo-icon {
      background: var(--secondary);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
    }
    
    .admin-logo-text h1 {
      font-size: 1.8rem;
      font-weight: 700;
    }
    
    .admin-logo-text p {
      font-size: 0.9rem;
      color: #cbd5e0;
    }
    
    .logout-btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .logout-btn:hover {
      background: #c53030;
      transform: translateY(-3px);
    }
    
    .admin-main {
      display: flex;
      min-height: 600px;
    }
    
    .admin-sidebar {
      width: 280px;
      background: rgba(0, 0, 0, 0.2);
      padding: 30px 0;
    }
    
    .admin-nav {
      list-style: none;
    }
    
    .admin-nav li {
      margin-bottom: 5px;
    }
    
    .admin-nav a {
      display: flex;
      align-items: center;
      padding: 15px 30px;
      color: #cbd5e0;
      text-decoration: none;
      transition: all 0.3s ease;
      font-weight: 500;
      gap: 12px;
    }
    
    .admin-nav a:hover,
    .admin-nav a.active {
      background: rgba(49, 130, 206, 0.2);
      color: white;
    }
    
    .admin-nav a i {
      width: 24px;
      text-align: center;
    }
    
    .admin-content {
      flex: 1;
      padding: 30px;
      background: rgba(255, 255, 255, 0.03);
    }
    
    .section-title {
      font-size: 1.8rem;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--secondary);
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    /* Formulaire d'ajout */
    .car-form {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 40px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .form-row {
      display: flex;
      flex-wrap: wrap;
      margin: 0 -15px;
    }
    
    .form-group {
      flex: 1 0 calc(50% - 30px);
      margin: 0 15px 25px;
    }
    
    .form-group.full-width {
      flex: 1 0 calc(100% - 30px);
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #cbd5e0;
    }
    
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 14px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
      color: white;
    }
    
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--secondary);
      box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.3);
    }
    
    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }
    
    .image-preview {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 15px;
    }
    
    .preview-item {
      position: relative;
      width: 100px;
      height: 80px;
      border-radius: 8px;
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }
    
    .preview-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .remove-image {
      position: absolute;
      top: 5px;
      right: 5px;
      background: var(--accent);
      color: white;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      cursor: pointer;
    }
    
    .form-actions {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    .submit-btn {
      background: var(--secondary);
      color: white;
      border: none;
      padding: 15px 35px;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .submit-btn:hover {
      background: #2b6cb0;
      transform: translateY(-3px);
    }
    
    .reset-btn {
      background: transparent;
      color: var(--gray);
      border: 1px solid var(--gray);
      padding: 15px 25px;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .reset-btn:hover {
      color: white;
      border-color: white;
    }
    
    /* Liste des voitures */
    .cars-list {
      margin-top: 30px;
    }
    
    .cars-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
    }
    
    .car-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }
    
    .car-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }
    
    .car-image {
      height: 180px;
      overflow: hidden;
    }
    
    .car-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .car-content {
      padding: 20px;
    }
    
    .car-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
    }
    
    .car-title {
      font-size: 1.3rem;
      font-weight: 600;
    }
    
    .car-price {
      color: var(--secondary);
      font-weight: 700;
    }
    
    .car-details {
      display: grid;
      grid-template-columns: repeat(2, 1fr));
      gap: 10px;
      margin-bottom: 15px;
      font-size: 0.9rem;
      color: #a0aec0;
    }
    
    .car-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    .action-btn {
      flex: 1;
      padding: 10px;
      border-radius: 6px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }
    
    .edit-btn {
      background: rgba(49, 130, 206, 0.2);
      color: var(--secondary);
    }
    
    .edit-btn:hover {
      background: var(--secondary);
      color: white;
    }
    
    .delete-btn {
      background: rgba(229, 62, 62, 0.2);
      color: var(--accent);
    }
    
    .delete-btn:hover {
      background: var(--accent);
      color: white;
    }
    
    /* Login page */
    .login-container {
      max-width: 450px;
      width: 100%;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    
    .login-header {
      background: var(--primary);
      padding: 30px;
      text-align: center;
    }
    
    .login-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .login-logo-icon {
      background: var(--secondary);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
    }
    
    .login-title {
      font-size: 1.5rem;
      font-weight: 600;
    }
    
    .login-form {
      padding: 40px 30px;
    }
    
    .form-group-login {
      margin-bottom: 25px;
    }
    
    .form-group-login label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }
    
    .form-group-login input {
      width: 100%;
      padding: 14px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      font-size: 1rem;
      color: white;
      transition: all 0.3s ease;
    }
    
    .form-group-login input:focus {
      outline: none;
      border-color: var(--secondary);
      box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.3);
    }
    
    .login-btn {
      width: 100%;
      padding: 15px;
      background: var(--secondary);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .login-btn:hover {
      background: #2b6cb0;
      transform: translateY(-3px);
    }
    
    .notification {
      padding: 15px;
      margin: 20px 0;
      border-radius: 8px;
      text-align: center;
      display: none;
    }
    
    .success {
      background: rgba(72, 187, 120, 0.15);
      border: 1px solid var(--success);
      color: var(--success);
    }
    
    .error {
      background: rgba(229, 62, 62, 0.15);
      border: 1px solid var(--accent);
      color: var(--accent);
    }
    
    /* Responsive */
    @media (max-width: 992px) {
      .admin-main {
        flex-direction: column;
      }
      
      .admin-sidebar {
        width: 100%;
      }
    }
    
    @media (max-width: 768px) {
      .form-group {
        flex: 1 0 calc(100% - 30px);
      }
      
      .form-actions {
        flex-direction: column;
      }
      
      .submit-btn, .reset-btn {
        width: 100%;
        justify-content: center;
      }
    }
    
    @media (max-width: 576px) {
      .admin-header {
        flex-direction: column;
        gap: 20px;
      }
      
      .logout-btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <!-- Page de connexion -->
  <div id="loginPage" class="login-container">
    <div class="login-header">
      <div class="login-logo">
        <div class="login-logo-icon">
          <i class="fas fa-lock"></i>
        </div>
        <h2>Espace Admin</h2>
      </div>
      <p class="login-title">Connexion à l'administration</p>
    </div>
    
    <div class="login-form">
      <div class="notification error" id="loginError">
        <i class="fas fa-exclamation-circle"></i> Identifiants incorrects. Veuillez réessayer.
      </div>
      
      <div class="form-group-login">
        <label for="username">Nom d'utilisateur</label>
        <input type="text" id="username" placeholder="Entrez votre nom d'utilisateur" required>
      </div>
      
      <div class="form-group-login">
        <label for="password">Mot de passe</label>
        <input type="password" id="password" placeholder="Entrez votre mot de passe" required>
      </div>
      
      <button class="login-btn" id="loginBtn">
        <i class="fas fa-sign-in-alt"></i> Se connecter
      </button>
    </div>
  </div>
  
  <!-- Page d'administration (cachée par défaut) -->
  <div id="adminPage" class="admin-container" style="display: none;">
    <header class="admin-header">
      <div class="admin-logo">
        <div class="admin-logo-icon">
          <i class="fas fa-car"></i>
        </div>
        <div class="admin-logo-text">
          <h1>ElHaji Auto</h1>
          <p>Administration</p>
        </div>
      </div>
      <button class="logout-btn" id="logoutBtn">
        <i class="fas fa-sign-out-alt"></i> Déconnexion
      </button>
    </header>
    
    <div class="admin-main">
      <aside class="admin-sidebar">
        <ul class="admin-nav">
          <li><a href="#" class="active" data-section="gestion"><i class="fas fa-car"></i> Gestion des Voitures</a></li>
          <li><a href="#" data-section="ajout"><i class="fas fa-plus-circle"></i> Ajouter une Voiture</a></li>
          <li><a href="#" data-section="parametres"><i class="fas fa-cog"></i> Paramètres</a></li>
        </ul>
      </aside>
      
      <main class="admin-content">
        <!-- Section de gestion des voitures -->
        <section id="gestionSection">
          <h2 class="section-title"><i class="fas fa-list"></i> Liste des Voitures</h2>
          
          <div class="notification success" id="successNotification">
            <i class="fas fa-check-circle"></i> Opération effectuée avec succès !
          </div>
          
          <div class="cars-list">
            <div class="cars-grid" id="carsGrid">
              <!-- Les cartes de voitures seront injectées ici par JavaScript -->
            </div>
          </div>
        </section>
        
        <!-- Section d'ajout de voiture -->
        <section id="ajoutSection" style="display: none;">
          <h2 class="section-title"><i class="fas fa-plus-circle"></i> Ajouter une Voiture</h2>
          
          <div class="notification error" id="formError">
            <i class="fas fa-exclamation-circle"></i> Veuillez remplir tous les champs obligatoires.
          </div>
          
          <form class="car-form" id="carForm">
            <div class="form-row">
              <div class="form-group">
                <label for="carName">Nom du modèle *</label>
                <input type="text" id="carName" placeholder="Ex: Volkswagen Golf 7 GTI" required>
              </div>
              
              <div class="form-group">
                <label for="carPrice">Prix *</label>
                <input type="text" id="carPrice" placeholder="Ex: 100 000 DH" required>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="carYear">Année *</label>
                <input type="number" id="carYear" min="1980" max="2025" placeholder="Ex: 2018" required>
              </div>
              
              <div class="form-group">
                <label for="carMileage">Kilométrage *</label>
                <input type="text" id="carMileage" placeholder="Ex: 75 000 km" required>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="carFuel">Carburant *</label>
                <select id="carFuel" required>
                  <option value="">Sélectionnez</option>
                  <option value="essence">Essence</option>
                  <option value="diesel">Diesel</option>
                  <option value="hybride">Hybride</option>
                  <option value="electrique">Électrique</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="carTransmission">Transmission *</label>
                <select id="carTransmission" required>
                  <option value="">Sélectionnez</option>
                  <option value="manuelle">Manuelle</option>
                  <option value="automatique">Automatique</option>
                </select>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="carPower">Puissance *</label>
                <input type="text" id="carPower" placeholder="Ex: 140 ch" required>
              </div>
              
              <div class="form-group">
                <label for="carColor">Couleur *</label>
                <input type="text" id="carColor" placeholder="Ex: Gris métallisé" required>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group full-width">
                <label for="carDescription">Description *</label>
                <textarea id="carDescription" placeholder="Décrivez la voiture en détail..." required></textarea>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group full-width">
                <label for="carImages">Images (URLs séparées par des virgules) *</label>
                <textarea id="carImages" placeholder="https://image1.jpg, https://image2.jpg" required></textarea>
                <small>Entrez les URLs des images séparées par des virgules</small>
                
                <div class="image-preview" id="imagePreview">
                  <!-- Prévisualisation des images -->
                </div>
              </div>
            </div>
            
            <input type="hidden" id="carId">
            
            <div class="form-actions">
              <button type="submit" class="submit-btn" id="saveCarBtn">
                <i class="fas fa-save"></i> Enregistrer
              </button>
              <button type="reset" class="reset-btn" id="resetBtn">
                <i class="fas fa-times"></i> Annuler
              </button>
            </div>
          </form>
        </section>
        
        <!-- Section des paramètres -->
        <section id="parametresSection" style="display: none;">
          <h2 class="section-title"><i class="fas fa-cog"></i> Paramètres de l'Admin</h2>
          
          <div class="car-form">
            <div class="form-row">
              <div class="form-group">
                <label>Nom d'utilisateur actuel</label>
                <input type="text" value="admin" disabled>
              </div>
              
              <div class="form-group">
                <label for="newPassword">Nouveau mot de passe</label>
                <input type="password" id="newPassword" placeholder="Entrez un nouveau mot de passe">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group full-width">
                <label for="confirmPassword">Confirmer le nouveau mot de passe</label>
                <input type="password" id="confirmPassword" placeholder="Confirmez le nouveau mot de passe">
              </div>
            </div>
            
            <div class="form-actions">
              <button type="button" class="submit-btn" id="updatePasswordBtn">
                <i class="fas fa-key"></i> Mettre à jour le mot de passe
              </button>
            </div>
          </div>
          
          <div class="car-form" style="margin-top: 40px;">
            <h3 style="color: #cbd5e0; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
              <i class="fas fa-database"></i> Gestion des Données
            </h3>
            
            <div class="form-actions">
              <button type="button" class="submit-btn" id="exportDataBtn" style="background: var(--success);">
                <i class="fas fa-file-export"></i> Exporter les données
              </button>
              <button type="button" class="reset-btn" id="importDataBtn">
                <i class="fas fa-file-import"></i> Importer des données
              </button>
              <button type="button" class="reset-btn" id="resetDataBtn" style="color: var(--accent); border-color: var(--accent);">
                <i class="fas fa-trash-alt"></i> Réinitialiser les données
              </button>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    // Identification
    const loginPage = document.getElementById('loginPage');
    const adminPage = document.getElementById('adminPage');
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const loginError = document.getElementById('loginError');
    
    // Navigation
    const navLinks = document.querySelectorAll('.admin-nav a');
    const gestionSection = document.getElementById('gestionSection');
    const ajoutSection = document.getElementById('ajoutSection');
    const parametresSection = document.getElementById('parametresSection');
    
    // Formulaire
    const carForm = document.getElementById('carForm');
    const saveCarBtn = document.getElementById('saveCarBtn');
    const resetBtn = document.getElementById('resetBtn');
    const formError = document.getElementById('formError');
    const successNotification = document.getElementById('successNotification');
    const imagePreview = document.getElementById('imagePreview');
    const carImagesInput = document.getElementById('carImages');
    
    // Liste des voitures
    const carsGrid = document.getElementById('carsGrid');
    
    // Authentification
    const USERNAME = 'admin';
    const PASSWORD = 'elhajiauto123';
    
    // Gestion de la connexion
    loginBtn.addEventListener('click', () => {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      
      if(username === USERNAME && password === PASSWORD) {
        loginPage.style.display = 'none';
        adminPage.style.display = 'block';
        
        // Charger les voitures
        loadCars();
      } else {
        loginError.style.display = 'block';
      }
    });
    
    // Déconnexion
    logoutBtn.addEventListener('click', () => {
      adminPage.style.display = 'none';
      loginPage.style.display = 'block';
      document.getElementById('username').value = '';
      document.getElementById('password').value = '';
    });
    
    // Navigation admin
    navLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const section = this.getAttribute('data-section');
        
        // Mettre à jour la navigation
        navLinks.forEach(l => l.classList.remove('active'));
        this.classList.add('active');
        
        // Afficher la bonne section
        gestionSection.style.display = 'none';
        ajoutSection.style.display = 'none';
        parametresSection.style.display = 'none';
        
        if(section === 'gestion') {
          gestionSection.style.display = 'block';
          loadCars();
        } else if(section === 'ajout') {
          ajoutSection.style.display = 'block';
          resetForm();
        } else if(section === 'parametres') {
          parametresSection.style.display = 'block';
        }
      });
    });
    
    // Prévisualisation des images
    carImagesInput.addEventListener('input', function() {
      const urls = this.value.split(',').map(url => url.trim()).filter(url => url);
      imagePreview.innerHTML = '';
      
      urls.forEach(url => {
        if(url) {
          const previewItem = document.createElement('div');
          previewItem.className = 'preview-item';
          previewItem.innerHTML = `
            <img src="${url}" alt="Preview">
            <div class="remove-image" data-url="${url}">&times;</div>
          `;
          imagePreview.appendChild(previewItem);
        }
      });
      
      // Gestion de la suppression d'image dans la prévisualisation
      document.querySelectorAll('.remove-image').forEach(btn => {
        btn.addEventListener('click', function() {
          const urlToRemove = this.getAttribute('data-url');
          const urls = carImagesInput.value.split(',').map(url => url.trim()).filter(url => url && url !== urlToRemove);
          carImagesInput.value = urls.join(', ');
          this.parentElement.remove();
        });
      });
    });
    
    // Sauvegarder une voiture
    carForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Validation
      if(!validateForm()) {
        formError.style.display = 'block';
        return;
      }
      
      formError.style.display = 'none';
      
      const carId = document.getElementById('carId').value;
      const carData = {
        id: carId || Date.now(), // Utiliser un nouvel ID si création
        name: document.getElementById('carName').value,
        year: document.getElementById('carYear').value,
        mileage: document.getElementById('carMileage').value,
        price: document.getElementById('carPrice').value,
        fuel: document.getElementById('carFuel').value,
        transmission: document.getElementById('carTransmission').value,
        power: document.getElementById('carPower').value,
        color: document.getElementById('carColor').value,
        description: document.getElementById('carDescription').value,
        images: document.getElementById('carImages').value.split(',').map(url => url.trim()).filter(url => url)
      };
      
      // Sauvegarder dans le localStorage
      saveCar(carData);
      
      // Afficher la notification de succès
      successNotification.style.display = 'block';
      successNotification.innerHTML = `
        <i class="fas fa-check-circle"></i> 
        Voiture ${carId ? 'modifiée' : 'ajoutée'} avec succès !
      `;
      
      // Cacher la notification après 3 secondes
      setTimeout(() => {
        successNotification.style.display = 'none';
      }, 3000);
      
      // Revenir à la liste et recharger
      gestionSection.style.display = 'block';
      ajoutSection.style.display = 'none';
      navLinks[0].classList.add('active');
      navLinks[1].classList.remove('active');
      
      loadCars();
    });
    
    // Réinitialiser le formulaire
    resetBtn.addEventListener('click', resetForm);
    
    // Validation du formulaire
    function validateForm() {
      const requiredFields = [
        'carName', 'carPrice', 'carYear', 'carMileage', 
        'carFuel', 'carTransmission', 'carPower', 
        'carColor', 'carDescription', 'carImages'
      ];
      
      for(const fieldId of requiredFields) {
        const field = document.getElementById(fieldId);
        if(!field.value.trim()) {
          field.focus();
          return false;
        }
      }
      
      return true;
    }
    
    // Réinitialiser le formulaire
    function resetForm() {
      carForm.reset();
      document.getElementById('carId').value = '';
      imagePreview.innerHTML = '';
      formError.style.display = 'none';
      saveCarBtn.innerHTML = '<i class="fas fa-save"></i> Enregistrer';
    }
    
    // Sauvegarder une voiture dans localStorage
    function saveCar(carData) {
      const cars = JSON.parse(localStorage.getItem('elhajiauto_cars') || '[]');
      
      if(carData.id) {
        // Modification
        const index = cars.findIndex(c => c.id == carData.id);
        if(index !== -1) {
          cars[index] = carData;
        } else {
          cars.push(carData);
        }
      } else {
        // Nouvelle voiture
        carData.id = Date.now();
        cars.push(carData);
      }
      
      localStorage.setItem('elhajiauto_cars', JSON.stringify(cars));
    }
    
    // Charger les voitures depuis localStorage
    function loadCars() {
      const cars = JSON.parse(localStorage.getItem('elhajiauto_cars') || '[]');
      carsGrid.innerHTML = '';
      
      if(cars.length === 0) {
        carsGrid.innerHTML = `
          <div class="no-cars" style="grid-column: 1/-1; text-align: center; padding: 40px; color: #a0aec0;">
            <i class="fas fa-car" style="font-size: 3rem; margin-bottom: 20px;"></i>
            <h3>Aucune voiture enregistrée</h3>
            <p>Commencez par ajouter une voiture en utilisant le formulaire d'ajout.</p>
          </div>
        `;
        return;
      }
      
      cars.forEach(car => {
        const carCard = document.createElement('div');
        carCard.className = 'car-card';
        carCard.innerHTML = `
          <div class="car-image">
            <img src="${car.images[0] || 'https://via.placeholder.com/300x180?text=Image+Manquante'}" alt="${car.name}">
          </div>
          <div class="car-content">
            <div class="car-header">
              <h3 class="car-title">${car.name}</h3>
              <div class="car-price">${car.price}</div>
            </div>
            <div class="car-details">
              <div><i class="fas fa-calendar"></i> ${car.year}</div>
              <div><i class="fas fa-tachometer-alt"></i> ${car.mileage}</div>
              <div><i class="fas fa-gas-pump"></i> ${car.fuel}</div>
              <div><i class="fas fa-cog"></i> ${car.transmission}</div>
            </div>
            <div class="car-actions">
              <button class="action-btn edit-btn" data-id="${car.id}">
                <i class="fas fa-edit"></i> Modifier
              </button>
              <button class="action-btn delete-btn" data-id="${car.id}">
                <i class="fas fa-trash-alt"></i> Supprimer
              </button>
            </div>
          </div>
        `;
        carsGrid.appendChild(carCard);
      });
      
      // Ajouter les événements pour modifier et supprimer
      document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const carId = this.getAttribute('data-id');
          editCar(carId);
        });
      });
      
      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const carId = this.getAttribute('data-id');
          deleteCar(carId);
        });
      });
    }
    
    // Modifier une voiture
    function editCar(carId) {
      const cars = JSON.parse(localStorage.getItem('elhajiauto_cars') || '[]');
      const car = cars.find(c => c.id == carId);
      
      if(car) {
        // Remplir le formulaire
        document.getElementById('carId').value = car.id;
        document.getElementById('carName').value = car.name;
        document.getElementById('carYear').value = car.year;
        document.getElementById('carMileage').value = car.mileage;
        document.getElementById('carPrice').value = car.price;
        document.getElementById('carFuel').value = car.fuel;
        document.getElementById('carTransmission').value = car.transmission;
        document.getElementById('carPower').value = car.power;
        document.getElementById('carColor').value = car.color;
        document.getElementById('carDescription').value = car.description;
        document.getElementById('carImages').value = car.images.join(', ');
        
        // Mettre à jour la prévisualisation
        const event = new Event('input', { bubbles: true });
        document.getElementById('carImages').dispatchEvent(event);
        
        // Changer le texte du bouton
        saveCarBtn.innerHTML = '<i class="fas fa-save"></i> Mettre à jour';
        
        // Naviguer vers le formulaire
        ajoutSection.style.display = 'block';
        gestionSection.style.display = 'none';
        navLinks[1].classList.add('active');
        navLinks[0].classList.remove('active');
      }
    }
    
    // Supprimer une voiture
    function deleteCar(carId) {
      if(confirm('Êtes-vous sûr de vouloir supprimer cette voiture ? Cette action est irréversible.')) {
        const cars = JSON.parse(localStorage.getItem('elhajiauto_cars') || '[]');
        const updatedCars = cars.filter(c => c.id != carId);
        
        localStorage.setItem('elhajiauto_cars', JSON.stringify(updatedCars));
        loadCars();
        
        // Afficher la notification de succès
        successNotification.style.display = 'block';
        successNotification.innerHTML = `
          <i class="fas fa-check-circle"></i> 
          Voiture supprimée avec succès !
        `;
        
        // Cacher la notification après 3 secondes
        setTimeout(() => {
          successNotification.style.display = 'none';
        }, 3000);
      }
    }
    
    // Initialisation
    document.addEventListener('DOMContentLoaded', () => {
      // Focus sur le champ username
      document.getElementById('username').focus();
    });
  </script>
</body>
</html>
